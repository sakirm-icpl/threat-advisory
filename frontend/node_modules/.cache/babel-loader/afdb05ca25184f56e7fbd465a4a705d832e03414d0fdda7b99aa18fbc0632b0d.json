{"ast":null,"code":"import React,{useState}from'react';import{useAuth}from'../hooks/useAuth';import{api}from'../services/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Profile(){const{user,refreshToken}=useAuth();const[email,setEmail]=useState((user===null||user===void 0?void 0:user.email)||'');const[emailMsg,setEmailMsg]=useState('');const[pwForm,setPwForm]=useState({old:'',new1:'',new2:''});const[pwMsg,setPwMsg]=useState('');const[pwLoading,setPwLoading]=useState(false);const[emailLoading,setEmailLoading]=useState(false);if(!user)return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});const handleEmailUpdate=async e=>{e.preventDefault();setEmailMsg('');setEmailLoading(true);try{await api.put('/auth/me',{email});setEmailMsg('Email updated successfully!');refreshToken();}catch(e){var _e$response,_e$response$data;setEmailMsg(((_e$response=e.response)===null||_e$response===void 0?void 0:(_e$response$data=_e$response.data)===null||_e$response$data===void 0?void 0:_e$response$data.error)||'Failed to update email');}setEmailLoading(false);};const handlePwChange=async e=>{e.preventDefault();setPwMsg('');if(pwForm.new1!==pwForm.new2){setPwMsg('New passwords do not match');return;}setPwLoading(true);try{await api.post('/auth/me/change-password',{old_password:pwForm.old,new_password:pwForm.new1});setPwMsg('Password changed successfully!');setPwForm({old:'',new1:'',new2:''});}catch(e){var _e$response2,_e$response2$data;setPwMsg(((_e$response2=e.response)===null||_e$response2===void 0?void 0:(_e$response2$data=_e$response2.data)===null||_e$response2$data===void 0?void 0:_e$response2$data.error)||'Failed to change password');}setPwLoading(false);};return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-xl mx-auto mt-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card mb-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold mb-4 text-blue-900\",children:\"Profile\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold\",children:\"Username:\"}),\" \",user.username]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold\",children:\"Email:\"}),\" \",user.email]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold\",children:\"Role:\"}),\" \",user.role]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold\",children:\"Created At:\"}),\" \",user.created_at?new Date(user.created_at).toLocaleString():'-']}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold\",children:\"Last Login:\"}),\" \",user.last_login?new Date(user.last_login).toLocaleString():'-']})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card mb-8\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold mb-2 text-blue-900\",children:\"Update Email\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleEmailUpdate,className:\"flex gap-2 items-end\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"email\",className:\"input-field flex-1\",value:email,onChange:e=>setEmail(e.target.value),required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn-primary\",disabled:emailLoading,children:emailLoading?'Saving...':'Update Email'})]}),emailMsg&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 text-sm text-blue-700\",children:emailMsg})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold mb-2 text-blue-900\",children:\"Change Password\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handlePwChange,className:\"space-y-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"input-field\",placeholder:\"Old password\",value:pwForm.old,onChange:e=>setPwForm(f=>({...f,old:e.target.value})),required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"input-field\",placeholder:\"New password\",value:pwForm.new1,onChange:e=>setPwForm(f=>({...f,new1:e.target.value})),required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"input-field\",placeholder:\"Confirm new password\",value:pwForm.new2,onChange:e=>setPwForm(f=>({...f,new2:e.target.value})),required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn-primary\",disabled:pwLoading,children:pwLoading?'Saving...':'Change Password'})]}),pwMsg&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 text-sm text-blue-700\",children:pwMsg})]})]});}","map":{"version":3,"names":["React","useState","useAuth","api","jsx","_jsx","jsxs","_jsxs","Profile","user","refreshToken","email","setEmail","emailMsg","setEmailMsg","pwForm","setPwForm","old","new1","new2","pwMsg","setPwMsg","pwLoading","setPwLoading","emailLoading","setEmailLoading","children","handleEmailUpdate","e","preventDefault","put","_e$response","_e$response$data","response","data","error","handlePwChange","post","old_password","new_password","_e$response2","_e$response2$data","className","username","role","created_at","Date","toLocaleString","last_login","onSubmit","type","value","onChange","target","required","disabled","placeholder","f"],"sources":["C:/Users/sakirm/Downloads/versionintel/frontend/src/pages/Profile.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { useAuth } from '../hooks/useAuth';\r\nimport { api } from '../services/api';\r\n\r\nexport default function Profile() {\r\n  const { user, refreshToken } = useAuth();\r\n  const [email, setEmail] = useState(user?.email || '');\r\n  const [emailMsg, setEmailMsg] = useState('');\r\n  const [pwForm, setPwForm] = useState({ old: '', new1: '', new2: '' });\r\n  const [pwMsg, setPwMsg] = useState('');\r\n  const [pwLoading, setPwLoading] = useState(false);\r\n  const [emailLoading, setEmailLoading] = useState(false);\r\n\r\n  if (!user) return <div>Loading...</div>;\r\n\r\n  const handleEmailUpdate = async (e) => {\r\n    e.preventDefault();\r\n    setEmailMsg('');\r\n    setEmailLoading(true);\r\n    try {\r\n      await api.put('/auth/me', { email });\r\n      setEmailMsg('Email updated successfully!');\r\n      refreshToken();\r\n    } catch (e) {\r\n      setEmailMsg(e.response?.data?.error || 'Failed to update email');\r\n    }\r\n    setEmailLoading(false);\r\n  };\r\n\r\n  const handlePwChange = async (e) => {\r\n    e.preventDefault();\r\n    setPwMsg('');\r\n    if (pwForm.new1 !== pwForm.new2) {\r\n      setPwMsg('New passwords do not match');\r\n      return;\r\n    }\r\n    setPwLoading(true);\r\n    try {\r\n      await api.post('/auth/me/change-password', {\r\n        old_password: pwForm.old,\r\n        new_password: pwForm.new1,\r\n      });\r\n      setPwMsg('Password changed successfully!');\r\n      setPwForm({ old: '', new1: '', new2: '' });\r\n    } catch (e) {\r\n      setPwMsg(e.response?.data?.error || 'Failed to change password');\r\n    }\r\n    setPwLoading(false);\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-xl mx-auto mt-8\">\r\n      <div className=\"card mb-8\">\r\n        <h2 className=\"text-xl font-bold mb-4 text-blue-900\">Profile</h2>\r\n        <div className=\"mb-2\"><span className=\"font-semibold\">Username:</span> {user.username}</div>\r\n        <div className=\"mb-2\"><span className=\"font-semibold\">Email:</span> {user.email}</div>\r\n        <div className=\"mb-2\"><span className=\"font-semibold\">Role:</span> {user.role}</div>\r\n        <div className=\"mb-2\"><span className=\"font-semibold\">Created At:</span> {user.created_at ? new Date(user.created_at).toLocaleString() : '-'}</div>\r\n        <div className=\"mb-2\"><span className=\"font-semibold\">Last Login:</span> {user.last_login ? new Date(user.last_login).toLocaleString() : '-'}</div>\r\n      </div>\r\n      <div className=\"card mb-8\">\r\n        <h3 className=\"text-lg font-semibold mb-2 text-blue-900\">Update Email</h3>\r\n        <form onSubmit={handleEmailUpdate} className=\"flex gap-2 items-end\">\r\n          <input\r\n            type=\"email\"\r\n            className=\"input-field flex-1\"\r\n            value={email}\r\n            onChange={e => setEmail(e.target.value)}\r\n            required\r\n          />\r\n          <button type=\"submit\" className=\"btn-primary\" disabled={emailLoading}>\r\n            {emailLoading ? 'Saving...' : 'Update Email'}\r\n          </button>\r\n        </form>\r\n        {emailMsg && <div className=\"mt-2 text-sm text-blue-700\">{emailMsg}</div>}\r\n      </div>\r\n      <div className=\"card\">\r\n        <h3 className=\"text-lg font-semibold mb-2 text-blue-900\">Change Password</h3>\r\n        <form onSubmit={handlePwChange} className=\"space-y-2\">\r\n          <input\r\n            type=\"password\"\r\n            className=\"input-field\"\r\n            placeholder=\"Old password\"\r\n            value={pwForm.old}\r\n            onChange={e => setPwForm(f => ({ ...f, old: e.target.value }))}\r\n            required\r\n          />\r\n          <input\r\n            type=\"password\"\r\n            className=\"input-field\"\r\n            placeholder=\"New password\"\r\n            value={pwForm.new1}\r\n            onChange={e => setPwForm(f => ({ ...f, new1: e.target.value }))}\r\n            required\r\n          />\r\n          <input\r\n            type=\"password\"\r\n            className=\"input-field\"\r\n            placeholder=\"Confirm new password\"\r\n            value={pwForm.new2}\r\n            onChange={e => setPwForm(f => ({ ...f, new2: e.target.value }))}\r\n            required\r\n          />\r\n          <button type=\"submit\" className=\"btn-primary\" disabled={pwLoading}>\r\n            {pwLoading ? 'Saving...' : 'Change Password'}\r\n          </button>\r\n        </form>\r\n        {pwMsg && <div className=\"mt-2 text-sm text-blue-700\">{pwMsg}</div>}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}