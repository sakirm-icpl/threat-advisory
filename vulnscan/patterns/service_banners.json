{
  "version": "1.0",
  "category": "service_banners",
  "description": "Service banner patterns for network service detection",
  "patterns": [
    {
      "name": "OpenSSH Server",
      "category": "service_banners",
      "pattern": "OpenSSH_([\\d\\.]+)",
      "vendor": "OpenBSD",
      "product": "OpenSSH",
      "version_group": 1,
      "priority": 200,
      "confidence": 0.95,
      "metadata": {
        "author": "Security Scanner Team",
        "created_at": "2024-01-01T00:00:00",
        "updated_at": "2024-01-01T00:00:00",
        "description": "Detects OpenSSH version from SSH banner",
        "tags": ["ssh", "openssh", "remote-access"],
        "test_cases": [
          {
            "input": "SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5",
            "expected_version": "8.2p1"
          },
          {
            "input": "SSH-2.0-OpenSSH_7.4",
            "expected_version": "7.4"
          }
        ]
      }
    },
    {
      "name": "MySQL Server",
      "category": "service_banners",
      "pattern": "([\\d\\.]+)-MySQL",
      "vendor": "Oracle",
      "product": "MySQL",
      "version_group": 1,
      "priority": 190,
      "confidence": 0.90,
      "metadata": {
        "author": "Security Scanner Team",
        "created_at": "2024-01-01T00:00:00",
        "updated_at": "2024-01-01T00:00:00",
        "description": "Detects MySQL version from service banner",
        "tags": ["database", "mysql"],
        "test_cases": [
          {
            "input": "5.7.37-0ubuntu0.18.04.1-MySQL",
            "expected_version": "5.7.37"
          },
          {
            "input": "8.0.32-MySQL",
            "expected_version": "8.0.32"
          }
        ]
      }
    },
    {
      "name": "PostgreSQL Server",
      "category": "service_banners",
      "pattern": "PostgreSQL ([\\d\\.]+)",
      "vendor": "PostgreSQL",
      "product": "PostgreSQL",
      "version_group": 1,
      "priority": 190,
      "confidence": 0.90,
      "metadata": {
        "author": "Security Scanner Team",
        "created_at": "2024-01-01T00:00:00",
        "updated_at": "2024-01-01T00:00:00",
        "description": "Detects PostgreSQL version from service banner",
        "tags": ["database", "postgresql"],
        "test_cases": [
          {
            "input": "PostgreSQL 13.7 on x86_64-pc-linux-gnu",
            "expected_version": "13.7"
          },
          {
            "input": "PostgreSQL 14.5",
            "expected_version": "14.5"
          }
        ]
      }
    },
    {
      "name": "FTP Server - vsftpd",
      "category": "service_banners",
      "pattern": "vsftpd ([\\d\\.]+)",
      "vendor": "vsftpd",
      "product": "vsftpd",
      "version_group": 1,
      "priority": 180,
      "confidence": 0.90,
      "metadata": {
        "author": "Security Scanner Team",
        "created_at": "2024-01-01T00:00:00",
        "updated_at": "2024-01-01T00:00:00",
        "description": "Detects vsftpd version from FTP banner",
        "tags": ["ftp", "vsftpd"],
        "test_cases": [
          {
            "input": "220 (vsFTPd 3.0.3)",
            "expected_version": "3.0.3"
          },
          {
            "input": "220 Welcome to vsftpd 2.3.5",
            "expected_version": "2.3.5"
          }
        ]
      }
    },
    {
      "name": "SMTP Server - Postfix",
      "category": "service_banners",
      "pattern": "Postfix\\s*\\(?([\\d\\.]+)?\\)?",
      "vendor": "Postfix",
      "product": "Postfix",
      "version_group": 1,
      "priority": 170,
      "confidence": 0.85,
      "metadata": {
        "author": "Security Scanner Team",
        "created_at": "2024-01-01T00:00:00",
        "updated_at": "2024-01-01T00:00:00",
        "description": "Detects Postfix version from SMTP banner",
        "tags": ["smtp", "postfix", "mail"],
        "test_cases": [
          {
            "input": "220 mail.example.com ESMTP Postfix (3.4.13)",
            "expected_version": "3.4.13"
          },
          {
            "input": "220 server ESMTP Postfix",
            "expected_version": null
          }
        ]
      }
    },
    {
      "name": "DNS Server - BIND",
      "category": "service_banners",
      "pattern": "BIND ([\\d\\.]+)",
      "vendor": "ISC",
      "product": "BIND",
      "version_group": 1,
      "priority": 180,
      "confidence": 0.90,
      "metadata": {
        "author": "Security Scanner Team",
        "created_at": "2024-01-01T00:00:00",
        "updated_at": "2024-01-01T00:00:00",
        "description": "Detects BIND DNS server version",
        "tags": ["dns", "bind"],
        "test_cases": [
          {
            "input": "BIND 9.16.1-Ubuntu",
            "expected_version": "9.16.1"
          },
          {
            "input": "BIND 9.11.3-1ubuntu1.17",
            "expected_version": "9.11.3"
          }
        ]
      }
    },
    {
      "name": "Redis Server",
      "category": "service_banners",
      "pattern": "Redis server v=([\\d\\.]+)",
      "vendor": "Redis",
      "product": "Redis",
      "version_group": 1,
      "priority": 180,
      "confidence": 0.90,
      "metadata": {
        "author": "Security Scanner Team",
        "created_at": "2024-01-01T00:00:00",
        "updated_at": "2024-01-01T00:00:00",
        "description": "Detects Redis server version from INFO response",
        "tags": ["database", "redis", "cache"],
        "test_cases": [
          {
            "input": "# Server\\nredis_version:6.0.16\\nRedis server v=6.0.16",
            "expected_version": "6.0.16"
          },
          {
            "input": "Redis server v=7.0.5",
            "expected_version": "7.0.5"
          }
        ]
      }
    }
  ]
}